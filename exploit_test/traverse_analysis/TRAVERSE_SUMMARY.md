# Traverse Tools Analysis Summary

## Tools Used
- **sol2cg**: Call Graph Generator - Maps function calls and control flow
- **sol-storage-analyzer**: Storage Analysis - Identifies read/write patterns for state variables

## Contracts Analyzed

### 1. XVIX Token (18,702 chars)
**Call Graph**: 270 edges, 60 call edges, 28 return edges

**Key Storage Access Patterns**:
| Function | Reads | Writes |
|----------|-------|--------|
| transfer | 16 variables including normalDivisor, rebaseBasisPoints | _normalSupply, balances, nextRebaseTime, normalDivisor |
| rebase | 7 variables including MAX_INTERVALS_PER_REBASE | nextRebaseTime, normalDivisor |
| mint | 6 variables | _normalSupply, balances |
| burn | 6 variables | _normalSupply, balances |
| createSafe | 7 variables | _normalSupply, _safeSupply, balances, safes |

**Potential Attack Surface**:
- Transfer triggers rebase which modifies normalDivisor
- Complex supply calculation depends on normalDivisor and safes
- Cross-function state dependencies

### 2. Minter Contract (2,963 chars)
**Call Graph**: 43 edges, 6 call edges, 4 return edges

**Key Storage Access Patterns**:
| Function | Reads | Writes |
|----------|-------|--------|
| mint | active, ethReserve, floor, xvix | ethReserve |
| enableMint | active, distributor | active, ethReserve |

**Potential Attack Surface**:
- enableMint sets ethReserve - initialization ordering matters
- mint reads floor contract - cross-contract dependency

### 3. Floor Contract (2,648 chars)
**Call Graph**: 23 edges, 5 call edges, 1 return edge

**Key Storage Access Patterns**:
| Function | Reads | Writes |
|----------|-------|--------|
| refund | BASIS_POINTS_DIVISOR, REFUND_BASIS_POINTS, capital, xvix | capital |
| getMaxMintAmount | capital, xvix | - |

**Potential Attack Surface**:
- capital state modified by refund
- Cross-contract calls to xvix token

### 4. Distributor Contract (12,594 chars)
**Call Graph**: 134 edges, 14 call edges, 11 return edges

**Key Storage Access Patterns**:
| Function | Reads | Writes |
|----------|-------|--------|
| initialize | 10+ variables | 12+ variables |
| join | 9 variables | ethReceived |
| endLGE | 10 variables | lgeIsActive |
| removeLiquidityDAI | 9 variables | - |
| removeLiquidityETH | 9 variables | - |

**Potential Attack Surface**:
- Complex initialization with multiple dependencies
- LGE end triggers multiple external calls
- Liquidity removal depends on timing conditions

### 5. UniswapV2Pair (9,972 chars)
**Call Graph**: 105 edges, 20 call edges, 0 return edges

**Key Storage Access Patterns**:
| Function | Reads | Writes |
|----------|-------|--------|
| swap | 5 variables (reserves, tokens, timestamp) | reserves, timestamp |
| mint | 7 variables | reserves, timestamp |
| burn | 8 variables | reserves, timestamp |

**Potential Attack Surface**:
- Standard Uniswap V2 - well-audited
- Reserve manipulation via flash swaps
- K-invariant calculations

### 6. LGEToken (4,344 chars)
**Call Graph**: 50 edges, 18 call edges, 0 return edges

**Key Storage Access Patterns**:
| Function | Reads | Writes |
|----------|-------|--------|
| mint | balances, totalSupply | balances, totalSupply |
| burn | balances, totalSupply | balances, totalSupply |
| setRefBalance | - | refBalance |
| setRefSupply | - | refSupply |

**Potential Attack Surface**:
- Reference balance/supply tracking may be exploitable
- Mint/burn access control critical

### 7. IDOLvsETHBoxExchange (84,675 chars)
**Call Graph**: 467 edges, 133 call edges

**Key Storage Access Patterns**:
| Function | Reads | Writes |
|----------|-------|--------|
| executeUnexecutedBox | boxExecutionStatus, orderBoxes, bookExecutionStatus | boxExecutionStatus, bookExecutionStatus |
| addLiquidity | reserve0, reserve1, balances, totalSupply | balances, totalSupply |
| withdrawETH | ethBalances | ethBalances |
| orderEthToToken | boxExecutionStatus, orderBoxes, bookExecutionStatus | boxExecutionStatus, bookExecutionStatus |

**Potential Attack Surface**:
- Box execution model with batched orders
- Internal reserve tracking (not external oracle)
- ETH balance withdrawal pattern (CEI compliant)

## Cross-Contract Vulnerability Patterns

### Pattern 1: XVIX Rebase + Transfer Interaction
- Transfer triggers rebase which modifies normalDivisor
- Balance calculations depend on normalDivisor
- Potential for read-only reentrancy during transfer

### Pattern 2: Minter -> Floor -> XVIX Chain
- Minter calls Floor.getMaxMintAmount
- Floor calls XVIX.balanceOf
- Chain of external calls with state dependencies

### Pattern 3: Distributor LGE Initialization
- Complex initialization with multiple contract dependencies
- Time-locked liquidity removal
- Path-dependent external calls to router

## High-Value Contract Analysis

### 8. EtherDelta Exchange (15,280 ETH) - 0x8d12a197
**Call Graph**: 242 edges, 32 call edges, 30 return edges

**Key Functions**:
- `withdraw()`: Uses CEI pattern (balance subtracted before external call)
- `trade()`: Complex order matching with signature verification
- `tradeBalances()`: Internal balance accounting

**Status**: Known historical exchange, follows CEI pattern. No new vulnerabilities identified.

### 9. MultiSigWalletWithDailyLimit (23,777 ETH) - 0xf4e11b89
Standard Gnosis-style multisig wallet with daily spending limit.
**Status**: Requires multiple owner signatures for operations. Not exploitable by external actors.

### 10. Parity Wallet (21,704 ETH) - 0x43ab6227
**CRITICAL FINDING**: This is the famous Parity multisig wallet!
- Uses delegatecall to library at `0x863df6bfa4469f3ead0be8f9f2aae51c91a907b4`
- Library was destroyed in November 2017 "accidental" freeze
- **Funds permanently locked** - not recoverable, not exploitable

### 11. TornadoCash ETH (17,050 ETH) - 0x910cbd52
Privacy-preserving mixer using ZK proofs.
- Deposit: merkle tree commitment
- Withdraw: ZK proof verification via IVerifier
**Status**: ZK-proof protected, not exploitable without breaking cryptography.

### 12. Exchange (16,524 ETH) - 0x2a0c0dbe
Empty storage analysis output (likely uses assembly).
**Status**: Requires further manual analysis.

## Summary of Findings

| Contract | Balance | Status | Exploitable |
|----------|---------|--------|-------------|
| Parity Wallet | 21,704 ETH | Library destroyed | No (frozen) |
| MultiSigWallet | 23,777 ETH | Requires signatures | No |
| TornadoCash | 17,050 ETH | ZK-proof protected | No |
| EtherDelta | 15,280 ETH | CEI pattern | No |
| Exchange | 16,524 ETH | Needs analysis | Unknown |
| XVIX Protocol | Variable | Complex rebasing | Needs deeper analysis |

## Recommendations for Further Investigation

1. **XVIX rebase timing attack**: Analyze if transfer can be timed to exploit normalDivisor changes
2. **Minter ethReserve manipulation**: Check if ethReserve can be manipulated before mint
3. **Distributor initialization race**: Check for front-running during initialization
4. **Cross-contract flash loan attack**: Model flash loan profitability for reserve manipulation
5. **Exchange 0x2a0c0dbe**: Manual analysis required due to assembly usage

## Traverse Tools Used

1. **sol2cg** - Call Graph Generator: Generated call graphs for 12 contracts
2. **sol-storage-analyzer** - Storage Analysis: Generated storage access patterns for all contracts

Note: storage-trace, sol2test, sol2bnd not available in current installation (not in cargo registry)
