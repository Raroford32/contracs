// SPDX-License-Identifier: MIT
pragma solidity ^0.8.19;

import "forge-std/Test.sol";

interface IInitializable {
    function initialize() external;
    function owner() external view returns (address);
}

contract UninitProxyCheckTest is Test {
    // Known implementation addresses from previous analysis
    address[] implementations = [
        0x678f0D5Aac7398502B50B24B3Ce67EA2dC4Fc29C,  // UserWithdrawalManager impl
        0x79b6eAbfFAa958FDF2Aa2Bf632878bD323DCbF69,  // L1ScrollMessenger impl
        0xBD6A5eC8A78B57871ae17d22cd686a72ebe06479   // RswEXIT impl
    ];
    
    function setUp() public {
        vm.createSelectFork("https://mainnet.infura.io/v3/bfc7283659224dd6b5124ebbc2b14e2c");
    }

    function testCheckInitialization() public {
        for (uint i = 0; i < implementations.length; i++) {
            address impl = implementations[i];
            console.log("\n=== Checking Implementation:", impl, "===");
            
            // Check if implementation has owner set
            try IInitializable(impl).owner() returns (address owner) {
                console.log("Owner:", owner);
                if (owner == address(0)) {
                    console.log("!!! UNINITIALIZED - owner is zero !!!");
                }
            } catch {
                console.log("No owner() function");
            }
            
            // Try to initialize
            try IInitializable(impl).initialize() {
                console.log("!!! initialize() SUCCEEDED - may be vulnerable !!!");
            } catch Error(string memory reason) {
                console.log("initialize() failed:", reason);
            } catch {
                console.log("initialize() failed (no reason)");
            }
        }
    }
}
