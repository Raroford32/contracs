# Manual Vulnerability Analysis Notes

## Session: Deep Analysis of contracts.txt

### Methodology
- Fetched contract source code via Etherscan API
- Analyzed state machines and emergent behavior
- Ran tests on mainnet fork to verify findings
- Calculated exact profit potential for attack vectors

---

## Contract Analysis Results

### 1. DolaSavings (0xE5f24791E273Cb96A1f8E5B67Bc2397F0AD9B8B4)

**Status: THEORETICAL VULNERABILITY - NOT EXPLOITABLE**

**Attack Vector:** Flash stake attack could capture 90% of pending rewards
- Flash loan DOLA from Balancer (0% fee)
- Stake massive amount, capture disproportionate rewards
- Unstake and repay

**Reality Check:**
- DBR balance in contract = 0
- No rewards to claim even if attack executed
- Theoretical issue but currently not exploitable

**Proof:** `test/ImmediateExploitSearch.t.sol` - testExactFlashLoanProfit()

---

### 2. 1inch st1INCH Pods System (0x9A0C8Ff858d273f57072D714bca7411D717501D7)

**Status: DESIGN ISSUE - NOT IMMEDIATE EXPLOIT**

**Findings:**
- When user adds a pod retroactively, pod receives notification as if tokens just deposited
- Pod call gas limit: 500,000 (sufficient for most operations)
- Pods limit: 5 per user

**Attack Scenario:**
- If a reward pod distributes based on "staking time"
- User stakes WITHOUT the reward pod
- Later adds reward pod
- Pod thinks user just staked - could game time-based rewards

**Why Not Immediate Exploit:**
- Depends on specific pod implementations
- No official 1inch reward pods identified with this issue
- User-controlled pod addition

**Proof:** `test/St1inchPodsAnalysis.t.sol`

---

### 3. Eigen Token (0xec53bf9167f50cdeb3ae105f56099aaab9061f83 proxy -> 0x2c4a81e257381f87f5a5c4bd525116466d972e50)

**Status: DESIGN DECISION - NOT VULNERABILITY**

**Findings:**
- `totalSupply()` returns `bEIGEN.totalSupply()` instead of actual EIGEN supply
- Minters can mint EIGEN without providing bEIGEN
- Transfer restrictions via allowlists (allowedFrom/allowedTo)

**Why Not Exploit:**
- Intentional design for backing token mechanics
- Minting restricted to authorized minters
- Would only affect external integrations that incorrectly assume totalSupply

---

### 4. Chainlink RewardVault (0x996913c8c08472f584ab8834e925b06D0eb1D813)

**Status: NO ISSUES FOUND**

**State:**
- LINK balance: 2.7M tokens
- Community/Operator/Delegated emission rates configured
- Not paused

**Analysis:**
- Standard emission-based reward distribution
- No obvious precision or timing exploits
- Access control properly implemented

**Proof:** `test/RewardVaultAnalysis.t.sol`

---

### 5. AevoStaking (0x38913051e01d4f6910cb66bb9ac3cb77d746ad81)

**Status: NO IMMEDIATE ISSUES**

**Findings:**
- uint16 epoch overflow: 458,066 days away (not immediate concern)
- Window size: 9 epochs
- Sliding window underflow: Not at risk with current epoch = 97

**Proof:** `test/AevoStakingAnalysis.t.sol`

---

### 6. Curve Peg Keeper V2 (0x9201da0D97CaAAff53f01B2fB56767C7072dE340)

**Status: UNABLE TO TEST - CONTRACT NOT FOUND**

**Notes:**
- Contract at address returns NotActivated errors
- May be on different chain or deactivated
- Need to verify correct address

---

### 7. EthenaMinting (0xe3490297a08d6fc8da46edb7b6142e4f461b62d3)

**Status: NEEDS DEEPER ANALYSIS**

**Interesting Areas:**
- EIP-712 signed orders with nonce bitmap deduplication
- Route-based collateral distribution to custodians
- Per-block mint/redeem limits
- Delegated signer system for smart contracts

**Potential Attack Vectors to Explore:**
1. Signature replay if domain separator computed incorrectly
2. Nonce bitmap manipulation
3. Route ratio manipulation for collateral theft
4. Cross-chain replay if chainId not properly enforced

---

## Summary

**PROVEN EXPLOITS:** 0
- No immediately exploitable vulnerabilities with > $1000 profit found

**THEORETICAL ISSUES:** 2
- DolaSavings flash stake (blocked by 0 DBR balance)
- st1INCH retroactive pod add (depends on pod implementations)

**DESIGN DECISIONS:** 1
- Eigen totalSupply() override

**NEEDS FURTHER ANALYSIS:** 1
- EthenaMinting signature/nonce system

---

## Next Steps

1. Deep dive into EthenaMinting nonce bitmap implementation
2. Search for contracts with:
   - Active reward balances
   - Custom accounting logic
   - Bridge/cross-chain components
3. Look for uninitialized proxy implementations
4. Analyze governance/timelock bypasses
