# XVIX Protocol Economic Analysis and Exploit Assessment

## Protocol State (Mainnet - Feb 2026)

| Parameter | Value |
|-----------|-------|
| Floor Contract | 0x40ed3699c2ffe43939ecf2f3d11f633b522820ad |
| Minter Contract | 0x452dcefd77ee4cc41373cc1a3207d8969f1c21b2 |
| XVIX Token | 0x4bAE380B5D762D543d426331b8437926443ae9ec |
| capital (TVL) | 336.04 ETH (~$1M) |
| totalSupply | 31,613.16 XVIX |
| normalDivisor | 601,351,545 |
| ethReserve | 1,292.99 ETH |
| Floor Price | 0.01063 ETH/XVIX |
| Minter Status | Active |

---

## Vulnerability Analysis

### Floor.refund() Cross-Contract Attack - MATH ANALYSIS

**Hypothesis:** Exploit refund callback to manipulate Minter.getMintAmount()

**getMaxMintAmount Formula:**
```
maxMint = ethAmount * totalSupply / capital
```

**Before Refund:**
- capital = C = 336 ETH
- totalSupply = S = 31,613 XVIX
- maxMint = X * 31613 / 336 = X * 94.08

**During Refund Callback (after burn):**
Let B = burnAmount, R = refundAmount = C * B / S * 0.9

- capital = C - R = C * (S - 0.9*B) / S
- totalSupply = S - B
- maxMint = X * (S - B) / (C * (S - 0.9*B) / S)
         = X * (S - B) * S / (C * (S - 0.9*B))

**Ratio Analysis:**
```
Ratio = [(S - B) * S] / [S * (S - 0.9*B)]
      = (S - B) / (S - 0.9*B)
```

For B = 10% of S:
```
Ratio = (S - 0.1S) / (S - 0.09S) = 0.9 / 0.91 = 0.989
```

**RESULT: Attacker gets 1.1% FEWER tokens via callback manipulation**

The math shows this attack vector is NOT PROFITABLE - the attacker would mint fewer tokens than normal, not more.

---

### Rebase Timing Attack - READ-ONLY REENTRANCY

**Attack Vector:**
XVIX.transfer() calls `rebase()` AFTER `_emitFloorPrice()`:

```solidity
function transfer(...) {
    _transfer(...);  // Includes _emitFloorPrice() external call
    rebase();        // normalDivisor changes AFTER
}
```

**Window of Inconsistency:**
Between `_emitFloorPrice()` and `rebase()`:
- Balances calculated with OLD normalDivisor
- Any external contract reading totalSupply() sees OLD value
- After rebase(), totalSupply() returns NEW value

**Practical Impact:**
- Requires another protocol to use XVIX.totalSupply() for pricing
- Sandwich attack to profit from stale oracle read
- Difficulty: HIGH (timing-dependent)

**Economic Assessment:**
```
normalDivisor increase per rebase = ~0.02% (rebaseBasisPoints = 2)
If rebase occurs during transaction:
- Price discrepancy = ~0.02%
- On 336 ETH TVL = ~0.067 ETH potential manipulation
- After gas costs (~0.05 ETH) = ~0.017 ETH profit
```

**RESULT: Marginal profitability, HIGH complexity**

---

### Flash Loan Attack Assessment

**Attack Requirements:**
1. Flash loan XVIX tokens (need liquidity source)
2. Flash loan ETH for minting
3. Execute refund + mint in same transaction

**XVIX Flash Loan Availability:**
- No native flash loan in XVIX contract
- Need DEX with XVIX liquidity (Uniswap/Sushiswap)
- Check liquidity depth

**Economic Model:**
```
Flash loan fee: 0.09% (Aave) or 0.3% (Uniswap)
Gas cost: ~0.1-0.5 ETH for complex attack
Minimum profitable TVL: ~500 ETH

Current TVL: 336 ETH
Result: MARGINAL - need significant price manipulation
```

---

## CONCLUSION

| Attack Vector | Profitable? | Complexity | Status |
|---------------|-------------|------------|--------|
| Floor.refund callback | NO | MEDIUM | Math unfavorable |
| Rebase timing attack | MARGINAL | HIGH | ~0.017 ETH profit |
| Flash loan manipulation | MARGINAL | HIGH | TVL too low |
| Cross-protocol oracle | POSSIBLE | HIGH | Requires target |

**Final Assessment:**
The XVIX protocol has theoretical vulnerabilities but:
1. The math for direct exploitation is unfavorable
2. TVL of 336 ETH limits profitable attack surface
3. Rebase timing attack has marginal returns
4. No clear path to $10K+ profit (E3 threshold)

**Risk Rating: LOW-MEDIUM**
- Vulnerabilities exist but are not economically exploitable at current TVL
- Would require significant external dependencies to exploit

---

## Recommendations for Continued Analysis

1. Monitor for TVL increases that might make attacks profitable
2. Search for protocols that use XVIX.totalSupply() for pricing
3. Check DEX liquidity for flash loan viability
4. Watch for governance changes to fee parameters
