# HashesDAO Contract Analysis
## Address: 0xbd3af18e0b7ebb30d49b253ab00788b92604552c
## Balance: 205.85 ETH

## Contract Overview
- Solidity 0.8.6
- ERC-721 token with governance features
- Uses OpenZeppelin's ReentrancyGuard

## Reentrancy Analysis

### Functions with _safeMint Callback

**generate() - Line 237-280**
```solidity
function generate(string memory _phrase) external nonReentrant payable {
    // (1) Compute hash
    nonceToHash[nonce] = keccak256(abi.encodePacked(nonce, _msgSender(), _phrase));

    // (2) Mint with callback
    _safeMint(_msgSender(), nonce++);  // ERC-721 callback point

    // (3) Send fee to owner
    (bool sent,) = owner().call{value: mintFee}("");

    // (4) Refund excess
    (bool sent,) = _msgSender().call{value: msg.value - mintFeePaid}("");
}
```

**Protection Status**: ✅ PROTECTED
- Has `nonReentrant` modifier
- Prevents recursive calls to same function
- Prevents cross-function reentrancy to other nonReentrant functions

### Functions with ETH Transfers

| Function | nonReentrant | ETH Transfers |
|----------|--------------|---------------|
| generate() | ✅ | owner().call{value} + sender refund |
| activateTokens() | ✅ | owner().call{value} + sender refund |
| deactivateTokens() | ✅ | None (owner handles payment) |
| redeem() | ✅ | None |

### Governance Vote Updates

```solidity
function _beforeTokenTransfer(address from, address to, uint256 tokenId) internal override {
    super._beforeTokenTransfer(from, to, tokenId);
    if (tokenId < governanceCap && !deactivated[tokenId]) {
        _moveDelegates(from, to, 1);  // Votes updated BEFORE callback
    }
}
```

**Protection**: ✅ Votes are updated BEFORE the ERC-721 callback fires

### Cross-Function Reentrancy Check

During `_safeMint` callback in `generate()`:
- ❌ Can't call generate() - nonReentrant blocks
- ❌ Can't call activateTokens() - nonReentrant blocks
- ❌ Can't call deactivateTokens() - nonReentrant + onlyOwner
- ❌ Can't call redeem() - nonReentrant blocks
- ✅ Can call view functions (safe)

### Read-Only Reentrancy Check

During callback:
- `balanceOf(minter)` - reflects new token
- `getCurrentVotes(minter)` - reflects new votes
- `nonce` - already incremented

**No exploitable read-only reentrancy** - all state is consistent when callback fires

## Conclusion

| Vulnerability Type | Status |
|-------------------|--------|
| Single-function reentrancy | ✅ Protected (nonReentrant) |
| Cross-function reentrancy | ✅ Protected (nonReentrant on all) |
| Read-only reentrancy | ✅ Protected (consistent state) |
| ERC-721 callback attack | ✅ Protected (nonReentrant) |

**Final Assessment**: Contract is well-protected. No exploitable reentrancy vulnerability found.
